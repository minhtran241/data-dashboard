var app = require('express')();
var server = require('http').Server(app);
var io = require('socket.io')(server, {
  cors: {
    origin: 'http://localhost:1234',
    methods: ['GET', 'POST'],
    credentials: true,
  },
});

server.listen(8080);
console.log('Server listening on port :8080');

// app.get('/', function (req, res) {
//   res.sendFile(__dirname + '/index.html');
// });

const data = {
  plan: 'xxx',
  data: [
    {
      Id: '30aea40e380c',
      Name: 'Test SWMS',
      Lat: 21.02339363,
      Lng: 105.7939301,
      Time: 1672313433,
      UpT: 4,
      BatV: 11.05016899,
      SolV: 0,
      STemp: 26,
      WTs: 1,
      WT: 18.75,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 06:30:33',
    },
    {
      Id: '782184809290',
      Name: 'SWMS Van don 01',
      Lat: 20.08774376,
      Lng: 107.4884186,
      Time: 1672313479,
      UpT: 2444,
      BatV: 13.75724983,
      SolV: 21.62289619,
      STemp: 27.25,
      WTs: 1,
      WT: 18.08749962,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 06:31:19',
    },
    {
      Id: '30aea40e380c',
      Name: 'Test SWMS',
      Lat: 21.02339363,
      Lng: 105.7939301,
      Time: 1672314333,
      UpT: 6,
      BatV: 11.04066753,
      SolV: 0,
      STemp: 26,
      WTs: 1,
      WT: 18.75,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 06:45:33',
    },
    {
      Id: '782184809290',
      Name: 'SWMS Van don 01',
      Lat: 20.08774376,
      Lng: 107.4884186,
      Time: 1672314411,
      UpT: 2459,
      BatV: 13.76222992,
      SolV: 21.57984543,
      STemp: 27,
      WTs: 1,
      WT: 18.02499962,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 06:46:51',
    },
    {
      Id: '30aea40e380c',
      Name: 'Test SWMS',
      Lat: 21.02339363,
      Lng: 105.7939301,
      Time: 1672315234,
      UpT: 8,
      BatV: 11.03167725,
      SolV: 0,
      STemp: 25.75,
      WTs: 1,
      WT: 18.8125,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 07:00:34',
    },
    {
      Id: '782184809290',
      Name: 'SWMS Van don 01',
      Lat: 20.08774376,
      Lng: 107.4884186,
      Time: 1672315273,
      UpT: 2474,
      BatV: 13.760746,
      SolV: 21.16921043,
      STemp: 26.75,
      WTs: 1,
      WT: 18.08749962,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 07:01:13',
    },
    {
      Id: '30aea40e380c',
      Name: 'Test SWMS',
      Lat: 21.02339363,
      Lng: 105.7939301,
      Time: 1672316135,
      UpT: 2,
      BatV: 11.02641582,
      SolV: 0,
      STemp: 26,
      WTs: 1,
      WT: 18.8125,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 07:15:35',
    },
    {
      Id: '782184809290',
      Name: 'SWMS Van don 01',
      Lat: 20.08774376,
      Lng: 107.4884186,
      Time: 1672316211,
      UpT: 2489,
      BatV: 13.75816154,
      SolV: 21.44244003,
      STemp: 27,
      WTs: 1,
      WT: 18.08749962,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 07:16:51',
    },
    {
      Id: '30aea40e380c',
      Name: 'Test SWMS',
      Lat: 21.02339363,
      Lng: 105.7939301,
      Time: 1672317033,
      UpT: 17,
      BatV: 11.02604008,
      SolV: 0,
      STemp: 25.75,
      WTs: 1,
      WT: 18.8125,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 07:30:33',
    },
    {
      Id: '782184809290',
      Name: 'SWMS Van don 01',
      Lat: 20.08774376,
      Lng: 107.4884186,
      Time: 1672317072,
      UpT: 2504,
      BatV: 13.75689316,
      SolV: 21.25257111,
      STemp: 27.25,
      WTs: 1,
      WT: 18.08749962,
      WPs: 0,
      WP: 0,
      WDs: 0,
      WD: 0,
      WNs: 0,
      WN: 0,
      moment: '29/12/2022 07:31:12',
    },
  ],
};

io.on('connection', function (socket) {
  setInterval(function () {
    io.sockets.emit('stats_receive', data);
  }, 10000);
});
